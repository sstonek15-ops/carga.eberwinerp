<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>EberwineRP — Conectando… (Destellos globales)</title>

  <style>
    :root{
      --bg1:#0b1020; --bg2:#131a33;
      --fg:#f8fafc; --muted:#cbd5e1; --gold:#d4af37;
      --accent1:#1fb6ff; --accent2:#60a5fa;
    }
    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      display:flex; justify-content:center; align-items:center; margin:0; color:var(--fg);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;
      background:
        url('./assets/bg.jpg') center/cover no-repeat fixed,
        radial-gradient(1200px 600px at 20% 20%, rgba(31,182,255,.18), transparent 60%),
        radial-gradient(1200px 600px at 80% 80%, rgba(212,175,55,.12), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg1));
      overflow:hidden; min-height:100vh;
      cursor:auto;
    }

    /* Canvas de destellos de fondo */
    #magicBG{ position:fixed; inset:0; pointer-events:none; z-index:1; filter:blur(.15px) }

    /* UI principal */
    .wrap{
      position:relative; z-index:2; width:min(1200px,95vw);
      background: rgba(10,14,28,.55);
      border-radius: 22px; padding: 44px 36px; backdrop-filter: blur(8px);
      box-shadow: 0 18px 60px rgba(0,0,0,.45), inset 0 0 40px rgba(97,218,251,.06);
    }
    .wrap::before{ content:""; position:absolute; inset:0; border-radius:22px; pointer-events:none; padding:2px;
      background: linear-gradient(135deg, rgba(255,255,255,.75), rgba(255,255,255,.15) 18%, rgba(31,182,255,.7) 36%, rgba(96,165,250,.8) 48%, rgba(212,175,55,.85) 70%, rgba(255,255,255,.65) 100%);
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite:xor; mask-composite:exclude; box-shadow: 0 0 20px rgba(31,182,255,.35), 0 0 28px rgba(212,175,55,.25);
    }
    .wrap::after{ content:""; position:absolute; inset:8px; border-radius:20px; pointer-events:none; box-shadow: 0 12px 28px rgba(0,0,0,.35) inset, 0 -8px 18px rgba(0,0,0,.25) inset }

    /* Header */
    .top{ position:relative; display:flex; align-items:center; gap:16px }
    .logo{ width:68px; height:68px; border-radius:16px; object-fit:cover; border:1px solid rgba(255,255,255,.18); box-shadow: 0 6px 18px rgba(31,182,255,.35), 0 0 0 6px rgba(31,182,255,.10) }
    .title{ margin:0; font-weight:900; font-size:2.6rem; letter-spacing:.3px }
    .subtitle{ margin:.25rem 0 0; color:var(--muted) }

    /* deja hueco a la derecha para el QR */
    .title-wrap{ padding-right:150px; }

    /* QR anclado en la esquina superior derecha del header */
    .qr-badge{
      position:absolute; top:14px; right:14px;
      width:128px; height:128px;
      display:flex; align-items:center; justify-content:center;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(6px);
      box-shadow:0 8px 26px rgba(0,0,0,.35), inset 0 0 24px rgba(31,182,255,.08);
      text-decoration:none; z-index:5;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .qr-badge:hover{ transform:translateY(-1px); box-shadow:0 12px 32px rgba(0,0,0,.45), 0 0 18px rgba(31,182,255,.35); }
    .qr-badge img{
      width:96px; height:96px;
      image-rendering: crisp-edges; border-radius:8px;
      box-shadow: 0 0 0 1px rgba(255,255,255,.35);
    }

    /* Cards, barras, etc. */
    .grid{ display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:14px; margin-top:18px }
    .card{ background: rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:12px 14px; min-height:68px }
    .label{ font-size:12px; text-transform:uppercase; letter-spacing:.12em; color:#9aa6b2 }
    .value{ margin-top:6px; font-weight:600; font-size:1.2rem; text-shadow: 0 2px 14px rgba(31,182,255,.25) }

    .bar{ margin-top:18px; height:14px; border-radius:999px; background:rgba(255,255,255,.08); overflow:hidden; border:1px solid rgba(255,255,255,.07) }
    .bar>div{ height:100%; width:0%; background:linear-gradient(90deg, var(--accent1), var(--gold)); box-shadow:0 0 20px rgba(31,182,255,.5); transition:width .35s ease }

    .foot{ display:flex; justify-content:space-between; align-items:center; margin-top:14px; gap:10px }
    .small{ font-size:12px; color:#9aa6b2 }
    .tips{ font-size:13px; color:#e2e8f0 }
    .link{ color:#a5f3fc; text-decoration:none; border-bottom:1px dashed rgba(165,243,252,.6); }
    .link:hover{ opacity:.85 }

    details{ margin-top:16px }
    summary{ cursor:pointer }

    /* QR pequeño escaneable (debajo de “Discord”) */
    .qr-scan{
      width:110px; height:110px; margin-top:6px;
      border-radius:6px; image-rendering:crisp-edges;
      box-shadow:0 0 12px rgba(255,255,255,.1), 0 0 4px rgba(31,182,255,.3);
      transition:transform .2s ease, box-shadow .2s ease;
    }
    .qr-scan:hover{ transform:scale(1.05); box-shadow:0 0 18px rgba(31,182,255,.5); }

    /* Responsive */
    @media (max-width:900px){
      .qr-badge{ width:104px; height:104px; }
      .qr-badge img{ width:80px; height:80px; }
      .title-wrap{ padding-right:120px; }
    }
    @media (max-width:560px){
      .qr-badge{ display:none; }
    }
  </style>
</head>

<body>
  <!-- Canvas de destellos globales -->
  <canvas id="magicBG"></canvas>

  <!-- UI principal -->
  <div class="wrap" role="main" aria-label="Pantalla de carga EberwineRP">
    <div class="top">
      <img class="logo" src="./assets/logo.png" alt="Logo EberwineRP">

      <!-- IMPORTANTE: ahora sí usamos title-wrap -->
      <div class="title-wrap">
        <h1 class="title" id="serverName">EberwineRP</h1>
        <p class="subtitle small" id="serverSubtitle">Tejiendo hechizos y cargando recursos…</p>
      </div>

      <!-- QR fijo en la esquina superior derecha del header -->
      <div class="qr-badge">
        <a href="https://discord.gg/tuCodigo" target="_blank" rel="noopener" aria-label="Discord QR">
          <img src="./assets/eberqr.png" alt="QR Discord">
        </a>
        <a class="qr-text" href="https://discord.gg/tuCodigo" target="_blank" rel="noopener">Discord</a>
      </div>

    <!-- Normas rápidas -->
    <details open>
      <summary class="small">Normas rápidas</summary>
      <ol class="small" style="margin:.5rem 0 .25rem 1.25rem">
        <li>Rolea consecuencias de tus actos.</li>
        <li>No abuses de bugs; repórtalos al staff.</li>
        <li>OOC en /ooc; nunca te salgas rol.</li>
        <li>Rolea lesiones y evita powergaming.</li>
        <li>Evita metagaming; cuidado con los /pm.</li>
      </ol>
    </details>

    <div class="grid">
      <div class="card"><div class="label">Época</div><div class="value">Actualidad</div></div>
      <div class="card"><div class="label">Trama actual</div><div class="value">Bienvenidos a Hogwarts</div></div>
      <div class="card"><div class="label">Copa Clases</div><div class="value">—</div></div>
      <div class="card"><div class="label">Copa Pruebas</div><div class="value">—</div></div>
    </div>

    <div class="bar"><div id="progress"></div></div>

    <div class="foot">
      <div class="tips"><span id="tip">Consulta con /help al Staff si necesitas ayuda.'.</span></div>
      <div class="small" id="hostname">eberwinerp.com</div>
    </div>

    <!-- Texto de ayuda con el QR debajo de “Discord” -->
    <p class="small" style="opacity:.75;margin-top:10px">
      ¿Problemas de conexión? Revisa tu caché de Workshop o abre ticket.
      <span style="display:inline-flex;flex-direction:column;align-items:center;gap:6px;margin-left:6px">
      </span>
    </p>
  </div>

  <script>
    // Helpers y demo
    const $ = id => document.getElementById(id);
    const qs = new URLSearchParams(location.search);
    if (qs.get('steamid')) $('playerId').textContent = 'SteamID64: ' + qs.get('steamid');

    // Progreso demo
    const bar = $('progress'); let p = 0;
    (function tick(){ p = Math.min(100, p + (Math.random()*8 + 2)); bar.style.width = p + '%'; if (p < 96) setTimeout(tick, 420); })();

    // Tips demo
    const tips = [
      'Consejo: Usa /me y /do para describir acciones y enriquecer el rol.',
      'Consejo: Respeta el rol de tu casa y crea historias con otros jugadores.',
      'Consejo: Asiste a clase para aprender hechizos y adquirir experiencia.',
      'Consejo: No robes ni mates sin rol previo; evita el powergaming.',
      'Consejo: Respeta el rol de entorno, a los profesores y adultos.',
      'Consejo: Rolea consecuencias; los errores también cuentan historias.'
    ];
    setInterval(()=>{ $('tip').textContent = tips[Math.floor(Math.random()*tips.length)]; }, 4000);

    // Destellos globales (igual que antes)
    const canvas = $('magicBG'); const ctx = canvas.getContext('2d'); let W,H;
    function resize(){ W = canvas.width = innerWidth; H = canvas.height = innerHeight; } resize(); addEventListener('resize', resize);
    const palette = [ {h:210,s:'100%',l:'70%'}, {h:45,s:'100%',l:'60%'}, {h:0,s:'0%',l:'100%'} ];
    let motas = []; for(let i=0;i<160;i++){ motas.push({ x:Math.random()*W, y:Math.random()*H, vx:(Math.random()-.5)*0.2, vy:-(.15+Math.random()*0.35), r:Math.random()*1.4+.5, life:.5+Math.random()*1.5, color:palette[Math|Math.random()*palette.length] }); }
    function glow(x,y,r,color,a){ const g=ctx.createRadialGradient(x,y,0,x,y,r*3.2); g.addColorStop(0,`hsla(${color.h},${color.s},${color.l},${0.85*a})`); g.addColorStop(1,'rgba(255,255,255,0)'); ctx.fillStyle=g; ctx.beginPath(); ctx.arc(x,y,r*3.2,0,Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.fillStyle=`hsla(${color.h},${color.s},${color.l},${a})`; ctx.arc(x,y,r,0,Math.PI*2); ctx.fill(); }
    function loop(){ ctx.clearRect(0,0,W,H); for(let i=motas.length-1;i>=0;i--){ const p=motas[i]; p.x+=p.vx; p.y+=p.vy; p.life-=0.0025; if(p.y<-10||p.life<=0){ motas[i]={ x:Math.random()*W, y:H+10, vx:(Math.random()-.5)*0.2, vy:-(.15+Math.random()*0.35), r:Math.random()*1.4+.5, life:.5+Math.random()*1.5, color:palette[Math|Math.random()*palette.length] }; continue; } glow(p.x,p.y,p.r,p.color,Math.max(.3,p.life)); } requestAnimationFrame(loop); } loop();
  </script>
</body>
</html>
